# 智能评论位置跟踪系统 - 实际测试验证指南

## 测试环境信息
- 扩展版本：v0.1.2
- VS Code兼容性：^1.90.0
- 测试时间：2025年5月27日

## 核心修复项目
✅ **回车键问题修复** - 解决"打了个enter就显示位置失效"的问题
✅ **智能行号调整** - 自动处理简单的行号偏移（±3行范围）
✅ **增强置信度系统** - 分级要求（短距离60%，中距离70%，远距离80%）
✅ **前置上下文匹配** - 扩大搜索范围到5行，支持70%关键词匹配
✅ **实时响应优化** - 行号变化300ms快速响应

## 测试步骤

### 1. 基础功能测试
1. 打开 `test-position-tracking-demo.js` 文件
2. 选择代码行 `function calculateSum(a, b) {`
3. 使用快捷键 `Ctrl+Shift+C` 添加评论："这是加法函数的评论"
4. 验证评论是否正确显示在代码行旁边

### 2. 回车键问题测试（关键测试）
1. 在已添加评论的代码行**前面**按回车键插入空行
2. **期望结果**：评论位置自动调整，仍然指向正确的代码行
3. **验证方法**：检查评论是否仍然显示在 `function calculateSum(a, b) {` 行旁边

### 3. 多行插入测试
1. 在已评论的代码行前插入2-3行新代码
2. **期望结果**：评论位置自动向下调整对应行数
3. **验证方法**：评论应该仍然正确指向原始的代码行

### 4. 代码修改测试
1. 轻微修改被评论的代码行（例如修改变量名）
2. **期望结果**：评论位置保持不变，继续跟踪该行
3. **验证方法**：评论高亮应该仍然显示在修改后的代码行上

### 5. 距离测试
1. 在距离评论较远的位置（5-8行外）插入代码
2. **期望结果**：评论位置能够正确重新定位
3. **验证方法**：使用置信度系统进行智能匹配

### 6. 响应速度测试
1. 快速进行多次编辑操作
2. **期望结果**：评论位置在300ms内快速响应更新
3. **验证方法**：观察评论高亮是否实时更新

## 成功标准
- ✅ 按回车键后评论位置不失效
- ✅ 评论能够自动跟踪代码行的移动
- ✅ 300ms内快速响应位置变化
- ✅ 多种编辑操作下位置保持准确
- ✅ 置信度系统正确工作

## 如果测试失败
1. 检查VS Code开发者控制台是否有错误信息
2. 验证扩展是否正确加载：查看扩展面板
3. 重启VS Code重新加载扩展
4. 检查文件是否在Git仓库中（某些功能需要Git环境）

## 测试报告
请在测试完成后记录：
- [ ] 基础评论添加功能正常
- [ ] 回车键位置跟踪正常
- [ ] 多行插入位置调整正常
- [ ] 代码修改后位置保持正常
- [ ] 距离测试通过
- [ ] 响应速度满足要求

---
*此测试验证了智能评论位置跟踪系统的核心修复功能*
